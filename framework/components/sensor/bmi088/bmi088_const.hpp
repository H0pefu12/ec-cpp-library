
#ifndef EC_LIB_COMPONENTS_SENSOR_BMI088_BMI088_REG_H
#define EC_LIB_COMPONENTS_SENSOR_BMI088_BMI088_REG_H

#include "modules/typedefs.h"

constexpr fp32 BMI088_TEMP_FACTOR = 0.125f;
constexpr fp32 BMI088_TEMP_OFFSET = 23.0f;

constexpr unsigned int BMI088_WRITE_ACCEL_REG_NUM = 6;
constexpr unsigned int BMI088_WRITE_GYRO_REG_NUM = 6;

constexpr unsigned int BMI088_GYRO_DATA_READY_BIT = 0;
constexpr unsigned int BMI088_ACCEL_DATA_READY_BIT = 1;
constexpr unsigned int BMI088_ACCEL_TEMP_DATA_READY_BIT = 2;

constexpr unsigned int BMI088_LONG_DELAY_TIME = 80;
constexpr unsigned int BMI088_COM_WAIT_SENSOR_TIME = 150;

constexpr uint16_t BMI088_ACCEL_IIC_ADDRESS = (0x18 << 1);
constexpr uint16_t BMI088_GYRO_IIC_ADDRESS = (0x68 << 1);

#define BMI088_ACCEL_RANGE_3G
// #define BMI088_ACCEL_RANGE_6G
// #define BMI088_ACCEL_RANGE_12G
// #define BMI088_ACCEL_RANGE_24G

#define BMI088_GYRO_RANGE_2000
// #define BMI088_GYRO_RANGE_1000
// #define BMI088_GYRO_RANGE_500
// #define BMI088_GYRO_RANGE_250
// #define BMI088_GYRO_RANGE_125

constexpr fp32 BMI088_ACCEL_3G_SEN = 0.0008974358974f;
constexpr fp32 BMI088_ACCEL_6G_SEN = 0.00179443359375f;
constexpr fp32 BMI088_ACCEL_12G_SEN = 0.0035888671875f;
constexpr fp32 BMI088_ACCEL_24G_SEN = 0.007177734375f;

constexpr fp32 BMI088_GYRO_2000_SEN = 0.00106526443603169529841533860381f;
constexpr fp32 BMI088_GYRO_1000_SEN = 0.00053263221801584764920766930190693f;
constexpr fp32 BMI088_GYRO_500_SEN = 0.00026631610900792382460383465095346f;
constexpr fp32 BMI088_GYRO_250_SEN = 0.00013315805450396191230191732547673f;
constexpr fp32 BMI088_GYRO_125_SEN = 0.000066579027251980956150958662738366f;

/******************
 * REGISTERS
 ******************/

constexpr uint8_t BMI088_ACC_CHIP_ID = 0x00;  // who am i
constexpr uint8_t BMI088_ACC_CHIP_ID_VALUE = 0x1E;

constexpr uint8_t BMI088_ACC_ERR_REG = 0x02;
constexpr uint8_t BMI088_ACCEL_CONFIG_ERROR_SHIFTS = 0x2;
constexpr uint8_t BMI088_ACCEL_CONFIG_ERROR = (1 << BMI088_ACCEL_CONFIG_ERROR_SHIFTS);
constexpr uint8_t BMI088_FATAL_ERROR_SHIFTS = 0x0;

constexpr uint8_t BMI088_ACC_STATUS = 0x03;
constexpr uint8_t BMI088_ACCEL_DRDY_SHIFTS = 0x7;
constexpr uint8_t BMI088_ACCEL_DRDY = (1 << BMI088_ACCEL_DRDY_SHIFTS);

constexpr uint8_t BMI088_ACCEL_XOUT_L = 0x12;
constexpr uint8_t BMI088_ACCEL_XOUT_M = 0x13;
constexpr uint8_t BMI088_ACCEL_YOUT_L = 0x14;
constexpr uint8_t BMI088_ACCEL_YOUT_M = 0x15;
constexpr uint8_t BMI088_ACCEL_ZOUT_L = 0x16;
constexpr uint8_t BMI088_ACCEL_ZOUT_M = 0x17;

constexpr uint8_t BMI088_SENSORTIME_DATA_L = 0x18;
constexpr uint8_t BMI088_SENSORTIME_DATA_M = 0x19;
constexpr uint8_t BMI088_SENSORTIME_DATA_H = 0x1A;

constexpr uint8_t BMI088_ACC_INT_STAT_1 = 0x1D;
constexpr uint8_t BMI088_ACCEL_DRDY_INTERRUPT_SHFITS = 0x7;
constexpr uint8_t BMI088_ACCEL_DRDY_INTERRUPT = (1 << BMI088_ACCEL_DRDY_INTERRUPT_SHFITS);

constexpr uint8_t BMI088_TEMP_M = 0x22;

constexpr uint8_t BMI088_TEMP_L = 0x23;

constexpr uint8_t BMI088_ACC_CONF = 0x40;
constexpr uint8_t BMI088_ACC_CONF_MUST_Set = 0x80;
constexpr uint8_t BMI088_ACC_BWP_SHFITS = 0x4;
constexpr uint8_t BMI088_ACC_OSR4 = (0x0 << BMI088_ACC_BWP_SHFITS);
constexpr uint8_t BMI088_ACC_OSR2 = (0x1 << BMI088_ACC_BWP_SHFITS);
constexpr uint8_t BMI088_ACC_NORMAL = (0x2 << BMI088_ACC_BWP_SHFITS);

constexpr uint8_t BMI088_ACC_ODR_SHFITS = 0x0;
constexpr uint8_t BMI088_ACC_12_5_HZ = (0x5 << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_25_HZ = (0x6 << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_50_HZ = (0x7 << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_100_HZ = (0x8 << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_200_HZ = (0x9 << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_400_HZ = (0xA << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_800_HZ = (0xB << BMI088_ACC_ODR_SHFITS);
constexpr uint8_t BMI088_ACC_1600_HZ = (0xC << BMI088_ACC_ODR_SHFITS);

constexpr uint8_t BMI088_ACC_RANGE = 0x41;

constexpr uint8_t BMI088_ACC_RANGE_SHFITS = 0x0;
constexpr uint8_t BMI088_ACC_RANGE_3G = (0x0 << BMI088_ACC_RANGE_SHFITS);
constexpr uint8_t BMI088_ACC_RANGE_6G = (0x1 << BMI088_ACC_RANGE_SHFITS);
constexpr uint8_t BMI088_ACC_RANGE_12G = (0x2 << BMI088_ACC_RANGE_SHFITS);
constexpr uint8_t BMI088_ACC_RANGE_24G = (0x3 << BMI088_ACC_RANGE_SHFITS);

constexpr uint8_t BMI088_INT1_IO_CTRL = 0x53;
constexpr uint8_t BMI088_ACC_INT1_IO_ENABLE_SHFITS = 0x3;
constexpr uint8_t BMI088_ACC_INT1_IO_ENABLE = (0x1 << BMI088_ACC_INT1_IO_ENABLE_SHFITS);
constexpr uint8_t BMI088_ACC_INT1_GPIO_MODE_SHFITS = 0x2;
constexpr uint8_t BMI088_ACC_INT1_GPIO_PP = (0x0 << BMI088_ACC_INT1_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_ACC_INT1_GPIO_OD = (0x1 << BMI088_ACC_INT1_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_ACC_INT1_GPIO_LVL_SHFITS = 0x1;
constexpr uint8_t BMI088_ACC_INT1_GPIO_LOW = (0x0 << BMI088_ACC_INT1_GPIO_LVL_SHFITS);
constexpr uint8_t BMI088_ACC_INT1_GPIO_HIGH = (0x1 << BMI088_ACC_INT1_GPIO_LVL_SHFITS);

constexpr uint8_t BMI088_INT2_IO_CTRL = 0x54;
constexpr uint8_t BMI088_ACC_INT2_IO_ENABLE_SHFITS = 0x3;
constexpr uint8_t BMI088_ACC_INT2_IO_ENABLE = (0x1 << BMI088_ACC_INT2_IO_ENABLE_SHFITS);
constexpr uint8_t BMI088_ACC_INT2_GPIO_MODE_SHFITS = 0x2;
constexpr uint8_t BMI088_ACC_INT2_GPIO_PP = (0x0 << BMI088_ACC_INT2_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_ACC_INT2_GPIO_OD = (0x1 << BMI088_ACC_INT2_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_ACC_INT2_GPIO_LVL_SHFITS = 0x1;
constexpr uint8_t BMI088_ACC_INT2_GPIO_LOW = (0x0 << BMI088_ACC_INT2_GPIO_LVL_SHFITS);
constexpr uint8_t BMI088_ACC_INT2_GPIO_HIGH = (0x1 << BMI088_ACC_INT2_GPIO_LVL_SHFITS);

constexpr uint8_t BMI088_INT_MAP_DATA = 0x58;
constexpr uint8_t BMI088_ACC_INT2_DRDY_INTERRUPT_SHFITS = 0x6;
constexpr uint8_t BMI088_ACC_INT2_DRDY_INTERRUPT = (0x1 << BMI088_ACC_INT2_DRDY_INTERRUPT_SHFITS);
constexpr uint8_t BMI088_ACC_INT1_DRDY_INTERRUPT_SHFITS = 0x2;
constexpr uint8_t BMI088_ACC_INT1_DRDY_INTERRUPT = (0x1 << BMI088_ACC_INT1_DRDY_INTERRUPT_SHFITS);

constexpr uint8_t BMI088_ACC_SELF_TEST = 0x6D;
constexpr uint8_t BMI088_ACC_SELF_TEST_OFF = 0x00;
constexpr uint8_t BMI088_ACC_SELF_TEST_POSITIVE_SIGNAL = 0x0D;
constexpr uint8_t BMI088_ACC_SELF_TEST_NEGATIVE_SIGNAL = 0x09;

constexpr uint8_t BMI088_ACC_PWR_CONF = 0x7C;
constexpr uint8_t BMI088_ACC_PWR_SUSPEND_MODE = 0x03;
constexpr uint8_t BMI088_ACC_PWR_ACTIVE_MODE = 0x00;

constexpr uint8_t BMI088_ACC_PWR_CTRL = 0x7D;
constexpr uint8_t BMI088_ACC_ENABLE_ACC_OFF = 0x00;
constexpr uint8_t BMI088_ACC_ENABLE_ACC_ON = 0x04;

constexpr uint8_t BMI088_ACC_SOFTRESET = 0x7E;
constexpr uint8_t BMI088_ACC_SOFTRESET_VALUE = 0xB6;

constexpr uint8_t BMI088_GYRO_CHIP_ID = 0x00;
constexpr uint8_t BMI088_GYRO_CHIP_ID_VALUE = 0x0F;

constexpr uint8_t BMI088_GYRO_X_L = 0x02;
constexpr uint8_t BMI088_GYRO_X_H = 0x03;
constexpr uint8_t BMI088_GYRO_Y_L = 0x04;
constexpr uint8_t BMI088_GYRO_Y_H = 0x05;
constexpr uint8_t BMI088_GYRO_Z_L = 0x06;
constexpr uint8_t BMI088_GYRO_Z_H = 0x07;

constexpr uint8_t BMI088_GYRO_INT_STAT_1 = 0x0A;
constexpr uint8_t BMI088_GYRO_DYDR_SHFITS = 0x7;
constexpr uint8_t BMI088_GYRO_DYDR = (0x1 << BMI088_GYRO_DYDR_SHFITS);

constexpr uint8_t BMI088_GYRO_RANGE = 0x0F;
constexpr uint8_t BMI088_GYRO_RANGE_SHFITS = 0x0;
constexpr uint8_t BMI088_GYRO_2000 = (0x0 << BMI088_GYRO_RANGE_SHFITS);
constexpr uint8_t BMI088_GYRO_1000 = (0x1 << BMI088_GYRO_RANGE_SHFITS);
constexpr uint8_t BMI088_GYRO_500 = (0x2 << BMI088_GYRO_RANGE_SHFITS);
constexpr uint8_t BMI088_GYRO_250 = (0x3 << BMI088_GYRO_RANGE_SHFITS);
constexpr uint8_t BMI088_GYRO_125 = (0x4 << BMI088_GYRO_RANGE_SHFITS);

constexpr uint8_t BMI088_GYRO_BANDWIDTH = 0x10;
// the first num means Output data rate, the second num means bandwidth
constexpr uint8_t BMI088_GYRO_BANDWIDTH_MUST_SET = 0x80;
constexpr uint8_t BMI088_GYRO_2000_532_HZ = 0x00;
constexpr uint8_t BMI088_GYRO_2000_230_HZ = 0x01;
constexpr uint8_t BMI088_GYRO_1000_116_HZ = 0x02;
constexpr uint8_t BMI088_GYRO_400_47_HZ = 0x03;
constexpr uint8_t BMI088_GYRO_200_23_HZ = 0x04;
constexpr uint8_t BMI088_GYRO_100_12_HZ = 0x05;
constexpr uint8_t BMI088_GYRO_200_64_HZ = 0x06;
constexpr uint8_t BMI088_GYRO_100_32_HZ = 0x07;

constexpr uint8_t BMI088_GYRO_LPM1 = 0x11;
constexpr uint8_t BMI088_GYRO_NORMAL_MODE = 0x00;
constexpr uint8_t BMI088_GYRO_SUSPEND_MODE = 0x80;
constexpr uint8_t BMI088_GYRO_DEEP_SUSPEND_MODE = 0x20;

constexpr uint8_t BMI088_GYRO_SOFTRESET = 0x14;
constexpr uint8_t BMI088_GYRO_SOFTRESET_VALUE = 0xB6;

constexpr uint8_t BMI088_GYRO_CTRL = 0x15;
constexpr uint8_t BMI088_DRDY_OFF = 0x00;
constexpr uint8_t BMI088_DRDY_ON = 0x80;

constexpr uint8_t BMI088_GYRO_INT3_INT4_IO_CONF = 0x16;
constexpr uint8_t BMI088_GYRO_INT4_GPIO_MODE_SHFITS = 0x3;
constexpr uint8_t BMI088_GYRO_INT4_GPIO_PP = (0x0 << BMI088_GYRO_INT4_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_GYRO_INT4_GPIO_OD = (0x1 << BMI088_GYRO_INT4_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_GYRO_INT4_GPIO_LVL_SHFITS = 0x2;
constexpr uint8_t BMI088_GYRO_INT4_GPIO_LOW = (0x0 << BMI088_GYRO_INT4_GPIO_LVL_SHFITS);
constexpr uint8_t BMI088_GYRO_INT4_GPIO_HIGH = (0x1 << BMI088_GYRO_INT4_GPIO_LVL_SHFITS);
constexpr uint8_t BMI088_GYRO_INT3_GPIO_MODE_SHFITS = 0x1;
constexpr uint8_t BMI088_GYRO_INT3_GPIO_PP = (0x0 << BMI088_GYRO_INT3_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_GYRO_INT3_GPIO_OD = (0x1 << BMI088_GYRO_INT3_GPIO_MODE_SHFITS);
constexpr uint8_t BMI088_GYRO_INT3_GPIO_LVL_SHFITS = 0x0;
constexpr uint8_t BMI088_GYRO_INT3_GPIO_LOW = (0x0 << BMI088_GYRO_INT3_GPIO_LVL_SHFITS);
constexpr uint8_t BMI088_GYRO_INT3_GPIO_HIGH = (0x1 << BMI088_GYRO_INT3_GPIO_LVL_SHFITS);

constexpr uint8_t BMI088_GYRO_INT3_INT4_IO_MAP = 0x18;

constexpr uint8_t BMI088_GYRO_DRDY_IO_OFF = 0x00;
constexpr uint8_t BMI088_GYRO_DRDY_IO_INT3 = 0x01;
constexpr uint8_t BMI088_GYRO_DRDY_IO_INT4 = 0x80;
constexpr uint8_t BMI088_GYRO_DRDY_IO_BOTH = (BMI088_GYRO_DRDY_IO_INT3 | BMI088_GYRO_DRDY_IO_INT4);

constexpr uint8_t BMI088_GYRO_SELF_TEST = 0x3C;
constexpr uint8_t BMI088_GYRO_RATE_OK_SHFITS = 0x4;
constexpr uint8_t BMI088_GYRO_RATE_OK = (0x1 << BMI088_GYRO_RATE_OK_SHFITS);
constexpr uint8_t BMI088_GYRO_BIST_FAIL_SHFITS = 0x2;
constexpr uint8_t BMI088_GYRO_BIST_FAIL = (0x1 << BMI088_GYRO_BIST_FAIL_SHFITS);
constexpr uint8_t BMI088_GYRO_BIST_RDY_SHFITS = 0x1;
constexpr uint8_t BMI088_GYRO_BIST_RDY = (0x1 << BMI088_GYRO_BIST_RDY_SHFITS);
constexpr uint8_t BMI088_GYRO_TRIG_BIST_SHFITS = 0x0;
constexpr uint8_t BMI088_GYRO_TRIG_BIST = (0x1 << BMI088_GYRO_TRIG_BIST_SHFITS);

#endif  // EC_LIB_COMPONENTS_SENSOR_BMI088_BMI088_REG_H
